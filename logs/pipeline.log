2025-11-11 12:53:43 - PhotoCropPipeline - INFO - ================================================================================
2025-11-11 12:53:43 - PhotoCropPipeline - INFO - INICIO DE PROCESADOR DETERMINISTA
2025-11-11 12:53:43 - PhotoCropPipeline - INFO - ================================================================================
2025-11-11 12:53:43 - PhotoCropPipeline - INFO - Configuraci√≥n cargada desde: ./config/paths.json
2025-11-11 12:53:44 - PhotoCropPipeline - INFO - Inicializaci√≥n completada
2025-11-11 12:53:44 - PhotoCropPipeline - INFO - ‚úì BackgroundRemover inicializado
2025-11-11 12:53:44 - PhotoCropPipeline - INFO - 
================================================================================
2025-11-11 12:53:44 - PhotoCropPipeline - INFO - 2. ESCANEO DE ENTRADA
2025-11-11 12:53:44 - PhotoCropPipeline - INFO - ================================================================================
2025-11-11 12:53:44 - PhotoCropPipeline - INFO - Total de archivos encontrados: 20
2025-11-11 12:53:44 - PhotoCropPipeline - INFO - 
================================================================================
2025-11-11 12:53:44 - PhotoCropPipeline - INFO - 3. FILTRADO DE ARCHIVOS NUEVOS
2025-11-11 12:53:44 - PhotoCropPipeline - INFO - ================================================================================
2025-11-11 12:53:44 - PhotoCropPipeline - INFO - Archivos nuevos a procesar: 20
2025-11-11 12:53:44 - PhotoCropPipeline - INFO - 
================================================================================
2025-11-11 12:53:44 - PhotoCropPipeline - INFO - 4. PROCESAMIENTO DE ARCHIVOS NUEVOS
2025-11-11 12:53:44 - PhotoCropPipeline - INFO - ================================================================================
2025-11-11 12:53:44 - PhotoCropPipeline - INFO - 
============================================================
2025-11-11 12:53:44 - PhotoCropPipeline - INFO - Procesando: 60620784.png
2025-11-11 12:53:44 - PhotoCropPipeline - INFO - ============================================================
2025-11-11 12:53:44 - PhotoCropPipeline - INFO - 4.1 Validaci√≥n b√°sica...
2025-11-11 12:53:44 - PhotoCropPipeline - INFO -   Dimensiones: 5100x7008
2025-11-11 12:53:44 - PhotoCropPipeline - INFO -   Formato: PNG
2025-11-11 12:53:44 - PhotoCropPipeline - INFO - 4.2 Creando metadato inicial...
2025-11-11 12:53:44 - PhotoCropPipeline - INFO -   Orientaci√≥n: portrait
2025-11-11 12:53:44 - PhotoCropPipeline - INFO - 4.3 Detecci√≥n facial con dlib...
2025-11-11 12:53:58 - PhotoCropPipeline - INFO -   Rostros detectados: 1
2025-11-11 12:53:58 - PhotoCropPipeline - INFO -   ‚úì Un rostro detectado
2025-11-11 12:53:58 - PhotoCropPipeline - INFO -   ‚úì Aplicando recorte...
2025-11-11 12:53:58 - PhotoCropPipeline - INFO -   ‚úì Guardado en working: working/faces_cropped/60620784.png
2025-11-11 12:53:58 - PhotoCropPipeline - INFO -   üé® Removiendo fondo con IA...
2025-11-11 12:53:59 - PhotoCropPipeline - INFO -   ‚úì Fondo removido: prepared/60620784.jpg
2025-11-11 12:53:59 - PhotoCropPipeline - INFO -   ‚úì Guardado en output_white: output_white/60620784.jpg
2025-11-11 12:53:59 - PhotoCropPipeline - INFO -   üîÑ Convirtiendo a formato original: .png
2025-11-11 12:54:00 - PhotoCropPipeline - INFO -   ‚úì Imagen procesada exitosamente ‚Üí output/60620784.png
2025-11-11 12:54:00 - PhotoCropPipeline - INFO - 
============================================================
2025-11-11 12:54:00 - PhotoCropPipeline - INFO - Procesando: 60357941.jpeg
2025-11-11 12:54:00 - PhotoCropPipeline - INFO - ============================================================
2025-11-11 12:54:00 - PhotoCropPipeline - INFO - 4.1 Validaci√≥n b√°sica...
2025-11-11 12:54:00 - PhotoCropPipeline - INFO -   Dimensiones: 354x472
2025-11-11 12:54:00 - PhotoCropPipeline - INFO -   Formato: JPEG
2025-11-11 12:54:00 - PhotoCropPipeline - INFO - 4.2 Creando metadato inicial...
2025-11-11 12:54:00 - PhotoCropPipeline - INFO -   Orientaci√≥n: portrait
2025-11-11 12:54:00 - PhotoCropPipeline - INFO - 4.3 Detecci√≥n facial con dlib...
2025-11-11 12:54:00 - PhotoCropPipeline - INFO -   Rostros detectados: 1
2025-11-11 12:54:00 - PhotoCropPipeline - INFO -   ‚úì Un rostro detectado
2025-11-11 12:54:00 - PhotoCropPipeline - INFO -   ‚úì Aplicando recorte...
2025-11-11 12:54:00 - PhotoCropPipeline - INFO -   ‚úì Guardado en working: working/faces_cropped/60357941.jpeg
2025-11-11 12:54:00 - PhotoCropPipeline - INFO -   üé® Removiendo fondo con IA...
2025-11-11 12:54:00 - PhotoCropPipeline - INFO -   ‚úì Fondo removido: prepared/60357941.jpg
2025-11-11 12:54:00 - PhotoCropPipeline - INFO -   ‚úì Guardado en output_white: output_white/60357941.jpg
2025-11-11 12:54:00 - PhotoCropPipeline - INFO -   üîÑ Convirtiendo a formato original: .jpeg
2025-11-11 12:54:00 - PhotoCropPipeline - INFO -   ‚úì Imagen procesada exitosamente ‚Üí output/60357941.jpeg
2025-11-11 12:54:00 - PhotoCropPipeline - INFO - 
============================================================
2025-11-11 12:54:00 - PhotoCropPipeline - INFO - Procesando: 60398193.png
2025-11-11 12:54:00 - PhotoCropPipeline - INFO - ============================================================
2025-11-11 12:54:00 - PhotoCropPipeline - INFO - 4.1 Validaci√≥n b√°sica...
2025-11-11 12:54:00 - PhotoCropPipeline - INFO -   Dimensiones: 1024x1536
2025-11-11 12:54:00 - PhotoCropPipeline - INFO -   Formato: PNG
2025-11-11 12:54:00 - PhotoCropPipeline - INFO - 4.2 Creando metadato inicial...
2025-11-11 12:54:00 - PhotoCropPipeline - INFO -   Orientaci√≥n: portrait
2025-11-11 12:54:00 - PhotoCropPipeline - INFO - 4.3 Detecci√≥n facial con dlib...
2025-11-11 12:54:01 - PhotoCropPipeline - INFO -   Rostros detectados: 1
2025-11-11 12:54:01 - PhotoCropPipeline - INFO -   ‚úì Un rostro detectado
2025-11-11 12:54:01 - PhotoCropPipeline - INFO -   ‚úì Aplicando recorte...
2025-11-11 12:54:01 - PhotoCropPipeline - INFO -   ‚úì Guardado en working: working/faces_cropped/60398193.png
2025-11-11 12:54:01 - PhotoCropPipeline - INFO -   üé® Removiendo fondo con IA...
2025-11-11 12:54:02 - PhotoCropPipeline - INFO -   ‚úì Fondo removido: prepared/60398193.jpg
2025-11-11 12:54:02 - PhotoCropPipeline - INFO -   ‚úì Guardado en output_white: output_white/60398193.jpg
2025-11-11 12:54:02 - PhotoCropPipeline - INFO -   üîÑ Convirtiendo a formato original: .png
2025-11-11 12:54:03 - PhotoCropPipeline - INFO -   ‚úì Imagen procesada exitosamente ‚Üí output/60398193.png
2025-11-11 12:54:03 - PhotoCropPipeline - INFO - 
============================================================
2025-11-11 12:54:03 - PhotoCropPipeline - INFO - Procesando: 60384891.jpg
2025-11-11 12:54:03 - PhotoCropPipeline - INFO - ============================================================
2025-11-11 12:54:03 - PhotoCropPipeline - INFO - 4.1 Validaci√≥n b√°sica...
2025-11-11 12:54:03 - PhotoCropPipeline - INFO -   Dimensiones: 1164x1455
2025-11-11 12:54:03 - PhotoCropPipeline - INFO -   Formato: PNG
2025-11-11 12:54:03 - PhotoCropPipeline - INFO - 4.2 Creando metadato inicial...
2025-11-11 12:54:03 - PhotoCropPipeline - INFO -   Orientaci√≥n: portrait
2025-11-11 12:54:03 - PhotoCropPipeline - INFO - 4.3 Detecci√≥n facial con dlib...
2025-11-11 12:54:03 - PhotoCropPipeline - INFO -   Rostros detectados: 1
2025-11-11 12:54:03 - PhotoCropPipeline - INFO -   ‚úì Un rostro detectado
2025-11-11 12:54:03 - PhotoCropPipeline - INFO -   ‚úì Aplicando recorte...
2025-11-11 12:54:03 - PhotoCropPipeline - ERROR - Error inesperado: cannot write mode RGBA as JPEG
Traceback (most recent call last):
  File "/home/lmayta/PycharmProjects/PhotoCrop/.venv/lib/python3.12/site-packages/PIL/JpegImagePlugin.py", line 662, in _save
    rawmode = RAWMODE[im.mode]
              ~~~~~~~^^^^^^^^^
KeyError: 'RGBA'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/lmayta/PycharmProjects/PhotoCrop/src/deterministic_processor.py", line 370, in _process_single_file
    self._handle_single_face(img_path, img, metadata, batch_id, face_box)
  File "/home/lmayta/PycharmProjects/PhotoCrop/src/deterministic_processor.py", line 523, in _handle_single_face
    self._process_successful_crop(img_path, img, metadata, batch_id, crop_decision["crop_box"])
  File "/home/lmayta/PycharmProjects/PhotoCrop/src/processor_with_bg_removal.py", line 104, in _process_successful_crop
    cropped_img.save(working_path, 'JPEG', quality=95)
  File "/home/lmayta/PycharmProjects/PhotoCrop/.venv/lib/python3.12/site-packages/PIL/Image.py", line 2571, in save
    save_handler(self, fp, filename)
  File "/home/lmayta/PycharmProjects/PhotoCrop/.venv/lib/python3.12/site-packages/PIL/JpegImagePlugin.py", line 665, in _save
    raise OSError(msg) from e
OSError: cannot write mode RGBA as JPEG
2025-11-11 12:54:03 - PhotoCropPipeline - ERROR -   ‚úó Error en procesamiento
2025-11-11 12:54:03 - PhotoCropPipeline - ERROR -   ‚úó Imagen con error ‚Üí errors/2025/batch_20251111_125343/60384891.jpg
2025-11-11 12:54:03 - PhotoCropPipeline - INFO - 
============================================================
2025-11-11 12:54:03 - PhotoCropPipeline - INFO - Procesando: 60400130.jpeg
2025-11-11 12:54:03 - PhotoCropPipeline - INFO - ============================================================
2025-11-11 12:54:03 - PhotoCropPipeline - INFO - 4.1 Validaci√≥n b√°sica...
2025-11-11 12:54:03 - PhotoCropPipeline - INFO -   Dimensiones: 240x288
2025-11-11 12:54:03 - PhotoCropPipeline - INFO -   Formato: JPEG
2025-11-11 12:54:03 - PhotoCropPipeline - INFO - 4.2 Creando metadato inicial...
2025-11-11 12:54:03 - PhotoCropPipeline - INFO -   Orientaci√≥n: portrait
2025-11-11 12:54:03 - PhotoCropPipeline - INFO - 4.3 Detecci√≥n facial con dlib...
2025-11-11 12:54:03 - PhotoCropPipeline - INFO -   Rostros detectados: 1
2025-11-11 12:54:03 - PhotoCropPipeline - INFO -   ‚úì Un rostro detectado
2025-11-11 12:54:03 - PhotoCropPipeline - INFO -   ‚úì Aplicando recorte...
2025-11-11 12:54:03 - PhotoCropPipeline - INFO -   ‚úì Guardado en working: working/faces_cropped/60400130.jpeg
2025-11-11 12:54:03 - PhotoCropPipeline - INFO -   üé® Removiendo fondo con IA...
2025-11-11 12:54:04 - PhotoCropPipeline - INFO -   ‚úì Fondo removido: prepared/60400130.jpg
2025-11-11 12:54:04 - PhotoCropPipeline - INFO -   ‚úì Guardado en output_white: output_white/60400130.jpg
2025-11-11 12:54:04 - PhotoCropPipeline - INFO -   üîÑ Convirtiendo a formato original: .jpeg
2025-11-11 12:54:04 - PhotoCropPipeline - INFO -   ‚úì Imagen procesada exitosamente ‚Üí output/60400130.jpeg
2025-11-11 12:54:04 - PhotoCropPipeline - INFO - 
============================================================
2025-11-11 12:54:04 - PhotoCropPipeline - INFO - Procesando: 60436492.jpeg
2025-11-11 12:54:04 - PhotoCropPipeline - INFO - ============================================================
2025-11-11 12:54:04 - PhotoCropPipeline - INFO - 4.1 Validaci√≥n b√°sica...
2025-11-11 12:54:04 - PhotoCropPipeline - INFO -   Dimensiones: 2066x3053
2025-11-11 12:54:04 - PhotoCropPipeline - INFO -   Formato: JPEG
2025-11-11 12:54:04 - PhotoCropPipeline - INFO - 4.2 Creando metadato inicial...
2025-11-11 12:54:04 - PhotoCropPipeline - INFO -   Orientaci√≥n: portrait
2025-11-11 12:54:04 - PhotoCropPipeline - INFO - 4.3 Detecci√≥n facial con dlib...
2025-11-11 12:54:06 - PhotoCropPipeline - INFO -   Rostros detectados: 1
2025-11-11 12:54:06 - PhotoCropPipeline - INFO -   ‚úì Un rostro detectado
2025-11-11 12:54:06 - PhotoCropPipeline - INFO -   ‚úì Aplicando recorte...
2025-11-11 12:54:06 - PhotoCropPipeline - INFO -   ‚úì Guardado en working: working/faces_cropped/60436492.jpeg
2025-11-11 12:54:06 - PhotoCropPipeline - INFO -   üé® Removiendo fondo con IA...
2025-11-11 12:54:08 - PhotoCropPipeline - INFO -   ‚úì Fondo removido: prepared/60436492.jpg
2025-11-11 12:54:08 - PhotoCropPipeline - INFO -   ‚úì Guardado en output_white: output_white/60436492.jpg
2025-11-11 12:54:08 - PhotoCropPipeline - INFO -   üîÑ Convirtiendo a formato original: .jpeg
2025-11-11 12:54:08 - PhotoCropPipeline - INFO -   ‚úì Imagen procesada exitosamente ‚Üí output/60436492.jpeg
2025-11-11 12:54:08 - PhotoCropPipeline - INFO - 
============================================================
2025-11-11 12:54:08 - PhotoCropPipeline - INFO - Procesando: 60577268.jpeg
2025-11-11 12:54:08 - PhotoCropPipeline - INFO - ============================================================
2025-11-11 12:54:08 - PhotoCropPipeline - INFO - 4.1 Validaci√≥n b√°sica...
2025-11-11 12:54:08 - PhotoCropPipeline - INFO -   Dimensiones: 1500x1494
2025-11-11 12:54:08 - PhotoCropPipeline - INFO -   Formato: JPEG
2025-11-11 12:54:08 - PhotoCropPipeline - INFO - 4.2 Creando metadato inicial...
2025-11-11 12:54:08 - PhotoCropPipeline - INFO -   Orientaci√≥n: square
2025-11-11 12:54:08 - PhotoCropPipeline - INFO - 4.3 Detecci√≥n facial con dlib...
2025-11-11 12:54:09 - PhotoCropPipeline - INFO -   Rostros detectados: 1
2025-11-11 12:54:09 - PhotoCropPipeline - INFO -   ‚úì Un rostro detectado
2025-11-11 12:54:09 - PhotoCropPipeline - INFO -   ‚úì Aplicando recorte...
2025-11-11 12:54:09 - PhotoCropPipeline - INFO -   ‚úì Guardado en working: working/faces_cropped/60577268.jpeg
2025-11-11 12:54:09 - PhotoCropPipeline - INFO -   üé® Removiendo fondo con IA...
2025-11-11 12:54:10 - PhotoCropPipeline - INFO -   ‚úì Fondo removido: prepared/60577268.jpg
2025-11-11 12:54:10 - PhotoCropPipeline - INFO -   ‚úì Guardado en output_white: output_white/60577268.jpg
2025-11-11 12:54:10 - PhotoCropPipeline - INFO -   üîÑ Convirtiendo a formato original: .jpeg
2025-11-11 12:54:10 - PhotoCropPipeline - INFO -   ‚úì Imagen procesada exitosamente ‚Üí output/60577268.jpeg
2025-11-11 12:54:10 - PhotoCropPipeline - INFO - 
============================================================
2025-11-11 12:54:10 - PhotoCropPipeline - INFO - Procesando: 60385017.jpeg
2025-11-11 12:54:10 - PhotoCropPipeline - INFO - ============================================================
2025-11-11 12:54:10 - PhotoCropPipeline - INFO - 4.1 Validaci√≥n b√°sica...
2025-11-11 12:54:10 - PhotoCropPipeline - INFO -   Dimensiones: 518x692
2025-11-11 12:54:10 - PhotoCropPipeline - INFO -   Formato: JPEG
2025-11-11 12:54:10 - PhotoCropPipeline - INFO - 4.2 Creando metadato inicial...
2025-11-11 12:54:10 - PhotoCropPipeline - INFO -   Orientaci√≥n: portrait
2025-11-11 12:54:10 - PhotoCropPipeline - INFO - 4.3 Detecci√≥n facial con dlib...
2025-11-11 12:54:10 - PhotoCropPipeline - INFO -   Rostros detectados: 1
2025-11-11 12:54:10 - PhotoCropPipeline - INFO -   ‚úì Un rostro detectado
2025-11-11 12:54:10 - PhotoCropPipeline - INFO -   ‚úì Aplicando recorte...
2025-11-11 12:54:10 - PhotoCropPipeline - INFO -   ‚úì Guardado en working: working/faces_cropped/60385017.jpeg
2025-11-11 12:54:10 - PhotoCropPipeline - INFO -   üé® Removiendo fondo con IA...
2025-11-11 12:54:11 - PhotoCropPipeline - INFO -   ‚úì Fondo removido: prepared/60385017.jpg
2025-11-11 12:54:11 - PhotoCropPipeline - INFO -   ‚úì Guardado en output_white: output_white/60385017.jpg
2025-11-11 12:54:11 - PhotoCropPipeline - INFO -   üîÑ Convirtiendo a formato original: .jpeg
2025-11-11 12:54:11 - PhotoCropPipeline - INFO -   ‚úì Imagen procesada exitosamente ‚Üí output/60385017.jpeg
2025-11-11 12:54:11 - PhotoCropPipeline - INFO - 
============================================================
2025-11-11 12:54:11 - PhotoCropPipeline - INFO - Procesando: 60387033.jpeg
2025-11-11 12:54:11 - PhotoCropPipeline - INFO - ============================================================
2025-11-11 12:54:11 - PhotoCropPipeline - INFO - 4.1 Validaci√≥n b√°sica...
2025-11-11 12:54:11 - PhotoCropPipeline - INFO -   Dimensiones: 1403x1600
2025-11-11 12:54:11 - PhotoCropPipeline - INFO -   Formato: JPEG
2025-11-11 12:54:11 - PhotoCropPipeline - INFO - 4.2 Creando metadato inicial...
2025-11-11 12:54:11 - PhotoCropPipeline - INFO -   Orientaci√≥n: portrait
2025-11-11 12:54:11 - PhotoCropPipeline - INFO - 4.3 Detecci√≥n facial con dlib...
2025-11-11 12:54:11 - PhotoCropPipeline - INFO -   Rostros detectados: 1
2025-11-11 12:54:11 - PhotoCropPipeline - INFO -   ‚úì Un rostro detectado
2025-11-11 12:54:11 - PhotoCropPipeline - INFO -   ‚úì Aplicando recorte...
2025-11-11 12:54:11 - PhotoCropPipeline - INFO -   ‚úì Guardado en working: working/faces_cropped/60387033.jpeg
2025-11-11 12:54:11 - PhotoCropPipeline - INFO -   üé® Removiendo fondo con IA...
2025-11-11 12:54:13 - PhotoCropPipeline - INFO -   ‚úì Fondo removido: prepared/60387033.jpg
2025-11-11 12:54:13 - PhotoCropPipeline - INFO -   ‚úì Guardado en output_white: output_white/60387033.jpg
2025-11-11 12:54:13 - PhotoCropPipeline - INFO -   üîÑ Convirtiendo a formato original: .jpeg
2025-11-11 12:54:13 - PhotoCropPipeline - INFO -   ‚úì Imagen procesada exitosamente ‚Üí output/60387033.jpeg
2025-11-11 12:54:13 - PhotoCropPipeline - INFO - 
============================================================
2025-11-11 12:54:13 - PhotoCropPipeline - INFO - Procesando: 60373110.jpeg
2025-11-11 12:54:13 - PhotoCropPipeline - INFO - ============================================================
2025-11-11 12:54:13 - PhotoCropPipeline - INFO - 4.1 Validaci√≥n b√°sica...
2025-11-11 12:54:13 - PhotoCropPipeline - INFO -   Dimensiones: 1200x1600
2025-11-11 12:54:13 - PhotoCropPipeline - INFO -   Formato: JPEG
2025-11-11 12:54:13 - PhotoCropPipeline - INFO - 4.2 Creando metadato inicial...
2025-11-11 12:54:13 - PhotoCropPipeline - INFO -   Orientaci√≥n: portrait
2025-11-11 12:54:13 - PhotoCropPipeline - INFO - 4.3 Detecci√≥n facial con dlib...
2025-11-11 12:54:13 - PhotoCropPipeline - INFO -   Rostros detectados: 1
2025-11-11 12:54:13 - PhotoCropPipeline - INFO -   ‚úì Un rostro detectado
2025-11-11 12:54:13 - PhotoCropPipeline - INFO -   ‚úì Aplicando recorte...
2025-11-11 12:54:13 - PhotoCropPipeline - INFO -   ‚úì Guardado en working: working/faces_cropped/60373110.jpeg
2025-11-11 12:54:13 - PhotoCropPipeline - INFO -   üé® Removiendo fondo con IA...
2025-11-11 12:54:14 - PhotoCropPipeline - INFO -   ‚úì Fondo removido: prepared/60373110.jpg
2025-11-11 12:54:14 - PhotoCropPipeline - INFO -   ‚úì Guardado en output_white: output_white/60373110.jpg
2025-11-11 12:54:14 - PhotoCropPipeline - INFO -   üîÑ Convirtiendo a formato original: .jpeg
2025-11-11 12:54:14 - PhotoCropPipeline - INFO -   ‚úì Imagen procesada exitosamente ‚Üí output/60373110.jpeg
2025-11-11 12:54:14 - PhotoCropPipeline - INFO - 
============================================================
2025-11-11 12:54:14 - PhotoCropPipeline - INFO - Procesando: 60407929.jpeg
2025-11-11 12:54:14 - PhotoCropPipeline - INFO - ============================================================
2025-11-11 12:54:14 - PhotoCropPipeline - INFO - 4.1 Validaci√≥n b√°sica...
2025-11-11 12:54:14 - PhotoCropPipeline - INFO -   Dimensiones: 240x288
2025-11-11 12:54:14 - PhotoCropPipeline - INFO -   Formato: JPEG
2025-11-11 12:54:14 - PhotoCropPipeline - INFO - 4.2 Creando metadato inicial...
2025-11-11 12:54:14 - PhotoCropPipeline - INFO -   Orientaci√≥n: portrait
2025-11-11 12:54:14 - PhotoCropPipeline - INFO - 4.3 Detecci√≥n facial con dlib...
2025-11-11 12:54:14 - PhotoCropPipeline - INFO -   Rostros detectados: 1
2025-11-11 12:54:14 - PhotoCropPipeline - INFO -   ‚úì Un rostro detectado
2025-11-11 12:54:14 - PhotoCropPipeline - INFO -   ‚úì Aplicando recorte...
2025-11-11 12:54:14 - PhotoCropPipeline - INFO -   ‚úì Guardado en working: working/faces_cropped/60407929.jpeg
2025-11-11 12:54:14 - PhotoCropPipeline - INFO -   üé® Removiendo fondo con IA...
2025-11-11 12:54:15 - PhotoCropPipeline - INFO -   ‚úì Fondo removido: prepared/60407929.jpg
2025-11-11 12:54:15 - PhotoCropPipeline - INFO -   ‚úì Guardado en output_white: output_white/60407929.jpg
2025-11-11 12:54:15 - PhotoCropPipeline - INFO -   üîÑ Convirtiendo a formato original: .jpeg
2025-11-11 12:54:15 - PhotoCropPipeline - INFO -   ‚úì Imagen procesada exitosamente ‚Üí output/60407929.jpeg
2025-11-11 12:54:15 - PhotoCropPipeline - INFO - 
============================================================
2025-11-11 12:54:15 - PhotoCropPipeline - INFO - Procesando: 60370297.jpeg
2025-11-11 12:54:15 - PhotoCropPipeline - INFO - ============================================================
2025-11-11 12:54:15 - PhotoCropPipeline - INFO - 4.1 Validaci√≥n b√°sica...
2025-11-11 12:54:15 - PhotoCropPipeline - INFO -   Dimensiones: 1130x1600
2025-11-11 12:54:15 - PhotoCropPipeline - INFO -   Formato: JPEG
2025-11-11 12:54:15 - PhotoCropPipeline - INFO - 4.2 Creando metadato inicial...
2025-11-11 12:54:15 - PhotoCropPipeline - INFO -   Orientaci√≥n: portrait
2025-11-11 12:54:15 - PhotoCropPipeline - INFO - 4.3 Detecci√≥n facial con dlib...
2025-11-11 12:54:16 - PhotoCropPipeline - INFO -   Rostros detectados: 1
2025-11-11 12:54:16 - PhotoCropPipeline - INFO -   ‚úì Un rostro detectado
2025-11-11 12:54:16 - PhotoCropPipeline - INFO -   ‚úì Aplicando recorte...
2025-11-11 12:54:16 - PhotoCropPipeline - INFO -   ‚úì Guardado en working: working/faces_cropped/60370297.jpeg
2025-11-11 12:54:16 - PhotoCropPipeline - INFO -   üé® Removiendo fondo con IA...
2025-11-11 12:54:16 - PhotoCropPipeline - INFO -   ‚úì Fondo removido: prepared/60370297.jpg
2025-11-11 12:54:16 - PhotoCropPipeline - INFO -   ‚úì Guardado en output_white: output_white/60370297.jpg
2025-11-11 12:54:16 - PhotoCropPipeline - INFO -   üîÑ Convirtiendo a formato original: .jpeg
2025-11-11 12:54:16 - PhotoCropPipeline - INFO -   ‚úì Imagen procesada exitosamente ‚Üí output/60370297.jpeg
2025-11-11 12:54:16 - PhotoCropPipeline - INFO - 
============================================================
2025-11-11 12:54:16 - PhotoCropPipeline - INFO - Procesando: 60345035.jpeg
2025-11-11 12:54:16 - PhotoCropPipeline - INFO - ============================================================
2025-11-11 12:54:16 - PhotoCropPipeline - INFO - 4.1 Validaci√≥n b√°sica...
2025-11-11 12:54:16 - PhotoCropPipeline - INFO -   Dimensiones: 240x288
2025-11-11 12:54:16 - PhotoCropPipeline - INFO -   Formato: JPEG
2025-11-11 12:54:16 - PhotoCropPipeline - INFO - 4.2 Creando metadato inicial...
2025-11-11 12:54:16 - PhotoCropPipeline - INFO -   Orientaci√≥n: portrait
2025-11-11 12:54:16 - PhotoCropPipeline - INFO - 4.3 Detecci√≥n facial con dlib...
2025-11-11 12:54:16 - PhotoCropPipeline - INFO -   Rostros detectados: 1
2025-11-11 12:54:16 - PhotoCropPipeline - INFO -   ‚úì Un rostro detectado
2025-11-11 12:54:16 - PhotoCropPipeline - INFO -   ‚úì Aplicando recorte...
2025-11-11 12:54:16 - PhotoCropPipeline - INFO -   ‚úì Guardado en working: working/faces_cropped/60345035.jpeg
2025-11-11 12:54:16 - PhotoCropPipeline - INFO -   üé® Removiendo fondo con IA...
2025-11-11 12:54:17 - PhotoCropPipeline - INFO -   ‚úì Fondo removido: prepared/60345035.jpg
2025-11-11 12:54:17 - PhotoCropPipeline - INFO -   ‚úì Guardado en output_white: output_white/60345035.jpg
2025-11-11 12:54:17 - PhotoCropPipeline - INFO -   üîÑ Convirtiendo a formato original: .jpeg
2025-11-11 12:54:17 - PhotoCropPipeline - INFO -   ‚úì Imagen procesada exitosamente ‚Üí output/60345035.jpeg
2025-11-11 12:54:17 - PhotoCropPipeline - INFO - 
============================================================
2025-11-11 12:54:17 - PhotoCropPipeline - INFO - Procesando: 60532190.jpg
2025-11-11 12:54:17 - PhotoCropPipeline - INFO - ============================================================
2025-11-11 12:54:17 - PhotoCropPipeline - INFO - 4.1 Validaci√≥n b√°sica...
2025-11-11 12:54:17 - PhotoCropPipeline - INFO -   Dimensiones: 290x448
2025-11-11 12:54:17 - PhotoCropPipeline - INFO -   Formato: PNG
2025-11-11 12:54:17 - PhotoCropPipeline - INFO - 4.2 Creando metadato inicial...
2025-11-11 12:54:17 - PhotoCropPipeline - INFO -   Orientaci√≥n: portrait
2025-11-11 12:54:17 - PhotoCropPipeline - INFO - 4.3 Detecci√≥n facial con dlib...
2025-11-11 12:54:17 - PhotoCropPipeline - INFO -   Rostros detectados: 1
2025-11-11 12:54:17 - PhotoCropPipeline - INFO -   ‚úì Un rostro detectado
2025-11-11 12:54:17 - PhotoCropPipeline - INFO -   ‚úì Aplicando recorte...
2025-11-11 12:54:17 - PhotoCropPipeline - ERROR - Error inesperado: cannot write mode RGBA as JPEG
Traceback (most recent call last):
  File "/home/lmayta/PycharmProjects/PhotoCrop/.venv/lib/python3.12/site-packages/PIL/JpegImagePlugin.py", line 662, in _save
    rawmode = RAWMODE[im.mode]
              ~~~~~~~^^^^^^^^^
KeyError: 'RGBA'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/lmayta/PycharmProjects/PhotoCrop/src/deterministic_processor.py", line 370, in _process_single_file
    self._handle_single_face(img_path, img, metadata, batch_id, face_box)
  File "/home/lmayta/PycharmProjects/PhotoCrop/src/deterministic_processor.py", line 523, in _handle_single_face
    self._process_successful_crop(img_path, img, metadata, batch_id, crop_decision["crop_box"])
  File "/home/lmayta/PycharmProjects/PhotoCrop/src/processor_with_bg_removal.py", line 104, in _process_successful_crop
    cropped_img.save(working_path, 'JPEG', quality=95)
  File "/home/lmayta/PycharmProjects/PhotoCrop/.venv/lib/python3.12/site-packages/PIL/Image.py", line 2571, in save
    save_handler(self, fp, filename)
  File "/home/lmayta/PycharmProjects/PhotoCrop/.venv/lib/python3.12/site-packages/PIL/JpegImagePlugin.py", line 665, in _save
    raise OSError(msg) from e
OSError: cannot write mode RGBA as JPEG
2025-11-11 12:54:17 - PhotoCropPipeline - ERROR -   ‚úó Error en procesamiento
2025-11-11 12:54:17 - PhotoCropPipeline - ERROR -   ‚úó Imagen con error ‚Üí errors/2025/batch_20251111_125343/60532190.jpg
2025-11-11 12:54:17 - PhotoCropPipeline - INFO - 
============================================================
2025-11-11 12:54:17 - PhotoCropPipeline - INFO - Procesando: 60604196.jpeg
2025-11-11 12:54:17 - PhotoCropPipeline - INFO - ============================================================
2025-11-11 12:54:17 - PhotoCropPipeline - INFO - 4.1 Validaci√≥n b√°sica...
2025-11-11 12:54:17 - PhotoCropPipeline - INFO -   Dimensiones: 847x1063
2025-11-11 12:54:17 - PhotoCropPipeline - INFO -   Formato: JPEG
2025-11-11 12:54:17 - PhotoCropPipeline - INFO - 4.2 Creando metadato inicial...
2025-11-11 12:54:17 - PhotoCropPipeline - INFO -   Orientaci√≥n: portrait
2025-11-11 12:54:17 - PhotoCropPipeline - INFO - 4.3 Detecci√≥n facial con dlib...
2025-11-11 12:54:17 - PhotoCropPipeline - INFO -   Rostros detectados: 1
2025-11-11 12:54:17 - PhotoCropPipeline - INFO -   ‚úì Un rostro detectado
2025-11-11 12:54:17 - PhotoCropPipeline - INFO -   ‚úì Aplicando recorte...
2025-11-11 12:54:17 - PhotoCropPipeline - INFO -   ‚úì Guardado en working: working/faces_cropped/60604196.jpeg
2025-11-11 12:54:17 - PhotoCropPipeline - INFO -   üé® Removiendo fondo con IA...
2025-11-11 12:54:18 - PhotoCropPipeline - INFO -   ‚úì Fondo removido: prepared/60604196.jpg
2025-11-11 12:54:18 - PhotoCropPipeline - INFO -   ‚úì Guardado en output_white: output_white/60604196.jpg
2025-11-11 12:54:18 - PhotoCropPipeline - INFO -   üîÑ Convirtiendo a formato original: .jpeg
2025-11-11 12:54:18 - PhotoCropPipeline - INFO -   ‚úì Imagen procesada exitosamente ‚Üí output/60604196.jpeg
2025-11-11 12:54:18 - PhotoCropPipeline - INFO - 
============================================================
2025-11-11 12:54:18 - PhotoCropPipeline - INFO - Procesando: 60397520.jpeg
2025-11-11 12:54:18 - PhotoCropPipeline - INFO - ============================================================
2025-11-11 12:54:18 - PhotoCropPipeline - INFO - 4.1 Validaci√≥n b√°sica...
2025-11-11 12:54:18 - PhotoCropPipeline - INFO -   Dimensiones: 600x600
2025-11-11 12:54:18 - PhotoCropPipeline - INFO -   Formato: JPEG
2025-11-11 12:54:18 - PhotoCropPipeline - INFO - 4.2 Creando metadato inicial...
2025-11-11 12:54:18 - PhotoCropPipeline - INFO -   Orientaci√≥n: square
2025-11-11 12:54:18 - PhotoCropPipeline - INFO - 4.3 Detecci√≥n facial con dlib...
2025-11-11 12:54:18 - PhotoCropPipeline - INFO -   Rostros detectados: 1
2025-11-11 12:54:18 - PhotoCropPipeline - INFO -   ‚úì Un rostro detectado
2025-11-11 12:54:18 - PhotoCropPipeline - INFO -   ‚úì Aplicando recorte...
2025-11-11 12:54:18 - PhotoCropPipeline - INFO -   ‚úì Guardado en working: working/faces_cropped/60397520.jpeg
2025-11-11 12:54:18 - PhotoCropPipeline - INFO -   üé® Removiendo fondo con IA...
2025-11-11 12:54:19 - PhotoCropPipeline - INFO -   ‚úì Fondo removido: prepared/60397520.jpg
2025-11-11 12:54:19 - PhotoCropPipeline - INFO -   ‚úì Guardado en output_white: output_white/60397520.jpg
2025-11-11 12:54:19 - PhotoCropPipeline - INFO -   üîÑ Convirtiendo a formato original: .jpeg
2025-11-11 12:54:19 - PhotoCropPipeline - INFO -   ‚úì Imagen procesada exitosamente ‚Üí output/60397520.jpeg
2025-11-11 12:54:19 - PhotoCropPipeline - INFO - 
============================================================
2025-11-11 12:54:19 - PhotoCropPipeline - INFO - Procesando: 60419232.jpg
2025-11-11 12:54:19 - PhotoCropPipeline - INFO - ============================================================
2025-11-11 12:54:19 - PhotoCropPipeline - INFO - 4.1 Validaci√≥n b√°sica...
2025-11-11 12:54:19 - PhotoCropPipeline - INFO -   Dimensiones: 267x345
2025-11-11 12:54:19 - PhotoCropPipeline - INFO -   Formato: PNG
2025-11-11 12:54:19 - PhotoCropPipeline - INFO - 4.2 Creando metadato inicial...
2025-11-11 12:54:19 - PhotoCropPipeline - INFO -   Orientaci√≥n: portrait
2025-11-11 12:54:19 - PhotoCropPipeline - INFO - 4.3 Detecci√≥n facial con dlib...
2025-11-11 12:54:19 - PhotoCropPipeline - INFO -   Rostros detectados: 1
2025-11-11 12:54:19 - PhotoCropPipeline - INFO -   ‚úì Un rostro detectado
2025-11-11 12:54:19 - PhotoCropPipeline - INFO -   ‚úì Aplicando recorte...
2025-11-11 12:54:19 - PhotoCropPipeline - ERROR - Error inesperado: cannot write mode RGBA as JPEG
Traceback (most recent call last):
  File "/home/lmayta/PycharmProjects/PhotoCrop/.venv/lib/python3.12/site-packages/PIL/JpegImagePlugin.py", line 662, in _save
    rawmode = RAWMODE[im.mode]
              ~~~~~~~^^^^^^^^^
KeyError: 'RGBA'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/lmayta/PycharmProjects/PhotoCrop/src/deterministic_processor.py", line 370, in _process_single_file
    self._handle_single_face(img_path, img, metadata, batch_id, face_box)
  File "/home/lmayta/PycharmProjects/PhotoCrop/src/deterministic_processor.py", line 523, in _handle_single_face
    self._process_successful_crop(img_path, img, metadata, batch_id, crop_decision["crop_box"])
  File "/home/lmayta/PycharmProjects/PhotoCrop/src/processor_with_bg_removal.py", line 104, in _process_successful_crop
    cropped_img.save(working_path, 'JPEG', quality=95)
  File "/home/lmayta/PycharmProjects/PhotoCrop/.venv/lib/python3.12/site-packages/PIL/Image.py", line 2571, in save
    save_handler(self, fp, filename)
  File "/home/lmayta/PycharmProjects/PhotoCrop/.venv/lib/python3.12/site-packages/PIL/JpegImagePlugin.py", line 665, in _save
    raise OSError(msg) from e
OSError: cannot write mode RGBA as JPEG
2025-11-11 12:54:19 - PhotoCropPipeline - ERROR -   ‚úó Error en procesamiento
2025-11-11 12:54:19 - PhotoCropPipeline - ERROR -   ‚úó Imagen con error ‚Üí errors/2025/batch_20251111_125343/60419232.jpg
2025-11-11 12:54:19 - PhotoCropPipeline - INFO - 
============================================================
2025-11-11 12:54:19 - PhotoCropPipeline - INFO - Procesando: 60568026.jpeg
2025-11-11 12:54:19 - PhotoCropPipeline - INFO - ============================================================
2025-11-11 12:54:19 - PhotoCropPipeline - INFO - 4.1 Validaci√≥n b√°sica...
2025-11-11 12:54:19 - PhotoCropPipeline - INFO -   Dimensiones: 1917x2405
2025-11-11 12:54:19 - PhotoCropPipeline - INFO -   Formato: JPEG
2025-11-11 12:54:19 - PhotoCropPipeline - INFO - 4.2 Creando metadato inicial...
2025-11-11 12:54:19 - PhotoCropPipeline - INFO -   Orientaci√≥n: portrait
2025-11-11 12:54:19 - PhotoCropPipeline - INFO - 4.3 Detecci√≥n facial con dlib...
2025-11-11 12:54:21 - PhotoCropPipeline - INFO -   Rostros detectados: 1
2025-11-11 12:54:21 - PhotoCropPipeline - INFO -   ‚úì Un rostro detectado
2025-11-11 12:54:21 - PhotoCropPipeline - INFO -   ‚úì Aplicando recorte...
2025-11-11 12:54:21 - PhotoCropPipeline - INFO -   ‚úì Guardado en working: working/faces_cropped/60568026.jpeg
2025-11-11 12:54:21 - PhotoCropPipeline - INFO -   üé® Removiendo fondo con IA...
2025-11-11 12:54:22 - PhotoCropPipeline - INFO -   ‚úì Fondo removido: prepared/60568026.jpg
2025-11-11 12:54:22 - PhotoCropPipeline - INFO -   ‚úì Guardado en output_white: output_white/60568026.jpg
2025-11-11 12:54:22 - PhotoCropPipeline - INFO -   üîÑ Convirtiendo a formato original: .jpeg
2025-11-11 12:54:22 - PhotoCropPipeline - INFO -   ‚úì Imagen procesada exitosamente ‚Üí output/60568026.jpeg
2025-11-11 12:54:22 - PhotoCropPipeline - INFO - 
============================================================
2025-11-11 12:54:22 - PhotoCropPipeline - INFO - Procesando: 60598120.jpeg
2025-11-11 12:54:22 - PhotoCropPipeline - INFO - ============================================================
2025-11-11 12:54:22 - PhotoCropPipeline - INFO - 4.1 Validaci√≥n b√°sica...
2025-11-11 12:54:22 - PhotoCropPipeline - INFO -   Dimensiones: 720x891
2025-11-11 12:54:22 - PhotoCropPipeline - INFO -   Formato: JPEG
2025-11-11 12:54:22 - PhotoCropPipeline - INFO - 4.2 Creando metadato inicial...
2025-11-11 12:54:22 - PhotoCropPipeline - INFO -   Orientaci√≥n: portrait
2025-11-11 12:54:22 - PhotoCropPipeline - INFO - 4.3 Detecci√≥n facial con dlib...
2025-11-11 12:54:23 - PhotoCropPipeline - INFO -   Rostros detectados: 1
2025-11-11 12:54:23 - PhotoCropPipeline - INFO -   ‚úì Un rostro detectado
2025-11-11 12:54:23 - PhotoCropPipeline - INFO -   ‚úì Aplicando recorte...
2025-11-11 12:54:23 - PhotoCropPipeline - INFO -   ‚úì Guardado en working: working/faces_cropped/60598120.jpeg
2025-11-11 12:54:23 - PhotoCropPipeline - INFO -   üé® Removiendo fondo con IA...
2025-11-11 12:54:23 - PhotoCropPipeline - INFO -   ‚úì Fondo removido: prepared/60598120.jpg
2025-11-11 12:54:23 - PhotoCropPipeline - INFO -   ‚úì Guardado en output_white: output_white/60598120.jpg
2025-11-11 12:54:23 - PhotoCropPipeline - INFO -   üîÑ Convirtiendo a formato original: .jpeg
2025-11-11 12:54:23 - PhotoCropPipeline - INFO -   ‚úì Imagen procesada exitosamente ‚Üí output/60598120.jpeg
2025-11-11 12:54:23 - PhotoCropPipeline - INFO - 
============================================================
2025-11-11 12:54:23 - PhotoCropPipeline - INFO - Procesando: 60596832.jpeg
2025-11-11 12:54:23 - PhotoCropPipeline - INFO - ============================================================
2025-11-11 12:54:23 - PhotoCropPipeline - INFO - 4.1 Validaci√≥n b√°sica...
2025-11-11 12:54:23 - PhotoCropPipeline - INFO -   Dimensiones: 764x928
2025-11-11 12:54:23 - PhotoCropPipeline - INFO -   Formato: JPEG
2025-11-11 12:54:23 - PhotoCropPipeline - INFO - 4.2 Creando metadato inicial...
2025-11-11 12:54:23 - PhotoCropPipeline - INFO -   Orientaci√≥n: portrait
2025-11-11 12:54:23 - PhotoCropPipeline - INFO - 4.3 Detecci√≥n facial con dlib...
2025-11-11 12:54:24 - PhotoCropPipeline - INFO -   Rostros detectados: 1
2025-11-11 12:54:24 - PhotoCropPipeline - INFO -   ‚úì Un rostro detectado
2025-11-11 12:54:24 - PhotoCropPipeline - INFO -   ‚úì Aplicando recorte...
2025-11-11 12:54:24 - PhotoCropPipeline - INFO -   ‚úì Guardado en working: working/faces_cropped/60596832.jpeg
2025-11-11 12:54:24 - PhotoCropPipeline - INFO -   üé® Removiendo fondo con IA...
2025-11-11 12:54:24 - PhotoCropPipeline - INFO -   ‚úì Fondo removido: prepared/60596832.jpg
2025-11-11 12:54:24 - PhotoCropPipeline - INFO -   ‚úì Guardado en output_white: output_white/60596832.jpg
2025-11-11 12:54:24 - PhotoCropPipeline - INFO -   üîÑ Convirtiendo a formato original: .jpeg
2025-11-11 12:54:24 - PhotoCropPipeline - INFO -   ‚úì Imagen procesada exitosamente ‚Üí output/60596832.jpeg
2025-11-11 12:54:24 - PhotoCropPipeline - INFO - 
================================================================================
2025-11-11 12:54:24 - PhotoCropPipeline - INFO - 7. RESUMEN DE PROCESAMIENTO
2025-11-11 12:54:24 - PhotoCropPipeline - INFO - ================================================================================
2025-11-11 12:54:24 - PhotoCropPipeline - INFO - Total encontrados: 20
2025-11-11 12:54:24 - PhotoCropPipeline - INFO - Saltados (ya procesados): 0
2025-11-11 12:54:24 - PhotoCropPipeline - INFO - Nuevos procesados:
2025-11-11 12:54:24 - PhotoCropPipeline - INFO -   ‚úì Exitosos: 17
2025-11-11 12:54:24 - PhotoCropPipeline - INFO -   ‚ö†Ô∏è  Revisi√≥n manual: 0
2025-11-11 12:54:24 - PhotoCropPipeline - INFO -   ‚úó Errores: 3
2025-11-11 12:54:24 - PhotoCropPipeline - INFO - ================================================================================
2025-11-11 13:03:57 - PhotoCropPipeline - INFO - ================================================================================
2025-11-11 13:03:57 - PhotoCropPipeline - INFO - INICIO DE PROCESADOR DETERMINISTA
2025-11-11 13:03:57 - PhotoCropPipeline - INFO - ================================================================================
2025-11-11 13:03:57 - PhotoCropPipeline - INFO - Configuraci√≥n cargada desde: ./config/paths.json
2025-11-11 13:03:57 - PhotoCropPipeline - INFO - Inicializaci√≥n completada
2025-11-11 13:03:57 - PhotoCropPipeline - INFO - ‚úì BackgroundRemover inicializado
2025-11-11 13:03:57 - PhotoCropPipeline - INFO - 
================================================================================
2025-11-11 13:03:57 - PhotoCropPipeline - INFO - 2. ESCANEO DE ENTRADA
2025-11-11 13:03:57 - PhotoCropPipeline - INFO - ================================================================================
2025-11-11 13:03:57 - PhotoCropPipeline - INFO - Total de archivos encontrados: 10
2025-11-11 13:03:57 - PhotoCropPipeline - INFO - 
================================================================================
2025-11-11 13:03:57 - PhotoCropPipeline - INFO - 3. FILTRADO DE ARCHIVOS NUEVOS
2025-11-11 13:03:57 - PhotoCropPipeline - INFO - ================================================================================
2025-11-11 13:03:57 - PhotoCropPipeline - INFO - Archivos nuevos a procesar: 10
2025-11-11 13:03:57 - PhotoCropPipeline - INFO - 
================================================================================
2025-11-11 13:03:57 - PhotoCropPipeline - INFO - 4. PROCESAMIENTO DE ARCHIVOS NUEVOS
2025-11-11 13:03:57 - PhotoCropPipeline - INFO - ================================================================================
2025-11-11 13:03:57 - PhotoCropPipeline - INFO - 
============================================================
2025-11-11 13:03:57 - PhotoCropPipeline - INFO - Procesando: 61424791.jpeg
2025-11-11 13:03:57 - PhotoCropPipeline - INFO - ============================================================
2025-11-11 13:03:57 - PhotoCropPipeline - INFO - 4.1 Validaci√≥n b√°sica...
2025-11-11 13:03:57 - PhotoCropPipeline - INFO -   Dimensiones: 1204x1600
2025-11-11 13:03:57 - PhotoCropPipeline - INFO -   Formato: JPEG
2025-11-11 13:03:57 - PhotoCropPipeline - INFO - 4.2 Creando metadato inicial...
2025-11-11 13:03:57 - PhotoCropPipeline - INFO -   Orientaci√≥n: portrait
2025-11-11 13:03:57 - PhotoCropPipeline - INFO - 4.3 Detecci√≥n facial con dlib...
2025-11-11 13:03:58 - PhotoCropPipeline - INFO -   Rostros detectados: 1
2025-11-11 13:03:58 - PhotoCropPipeline - INFO -   ‚úì Un rostro detectado
2025-11-11 13:03:58 - PhotoCropPipeline - INFO -   ‚úì Aplicando recorte...
2025-11-11 13:03:58 - PhotoCropPipeline - INFO -   ‚úì Guardado en working: working/faces_cropped/61424791.jpeg
2025-11-11 13:03:58 - PhotoCropPipeline - INFO -   üé® Removiendo fondo con IA...
2025-11-11 13:03:59 - PhotoCropPipeline - INFO -   ‚úì Fondo removido: prepared/61424791.jpg
2025-11-11 13:03:59 - PhotoCropPipeline - INFO -   ‚úì Guardado en output_white: output_white/61424791.jpeg
2025-11-11 13:03:59 - PhotoCropPipeline - INFO -   üîÑ Convirtiendo a formato original: .jpeg
2025-11-11 13:03:59 - PhotoCropPipeline - INFO -   ‚úì Imagen procesada exitosamente ‚Üí output/61424791.jpeg
2025-11-11 13:03:59 - PhotoCropPipeline - INFO - 
============================================================
2025-11-11 13:03:59 - PhotoCropPipeline - INFO - Procesando: 61425151.jpg
2025-11-11 13:03:59 - PhotoCropPipeline - INFO - ============================================================
2025-11-11 13:03:59 - PhotoCropPipeline - INFO - 4.1 Validaci√≥n b√°sica...
2025-11-11 13:03:59 - PhotoCropPipeline - INFO -   Dimensiones: 1199x1599
2025-11-11 13:03:59 - PhotoCropPipeline - INFO -   Formato: PNG
2025-11-11 13:03:59 - PhotoCropPipeline - INFO - 4.2 Creando metadato inicial...
2025-11-11 13:03:59 - PhotoCropPipeline - INFO -   Orientaci√≥n: portrait
2025-11-11 13:03:59 - PhotoCropPipeline - INFO - 4.3 Detecci√≥n facial con dlib...
2025-11-11 13:03:59 - PhotoCropPipeline - INFO -   Rostros detectados: 1
2025-11-11 13:03:59 - PhotoCropPipeline - INFO -   ‚úì Un rostro detectado
2025-11-11 13:03:59 - PhotoCropPipeline - INFO -   ‚úì Aplicando recorte...
2025-11-11 13:03:59 - PhotoCropPipeline - ERROR - Error inesperado: cannot write mode RGBA as JPEG
Traceback (most recent call last):
  File "/home/lmayta/PycharmProjects/PhotoCrop/.venv/lib/python3.12/site-packages/PIL/JpegImagePlugin.py", line 662, in _save
    rawmode = RAWMODE[im.mode]
              ~~~~~~~^^^^^^^^^
KeyError: 'RGBA'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/lmayta/PycharmProjects/PhotoCrop/src/deterministic_processor.py", line 370, in _process_single_file
    self._handle_single_face(img_path, img, metadata, batch_id, face_box)
  File "/home/lmayta/PycharmProjects/PhotoCrop/src/deterministic_processor.py", line 523, in _handle_single_face
    self._process_successful_crop(img_path, img, metadata, batch_id, crop_decision["crop_box"])
  File "/home/lmayta/PycharmProjects/PhotoCrop/src/processor_with_bg_removal.py", line 104, in _process_successful_crop
    cropped_img.save(working_path, 'JPEG', quality=95)
  File "/home/lmayta/PycharmProjects/PhotoCrop/.venv/lib/python3.12/site-packages/PIL/Image.py", line 2571, in save
    save_handler(self, fp, filename)
  File "/home/lmayta/PycharmProjects/PhotoCrop/.venv/lib/python3.12/site-packages/PIL/JpegImagePlugin.py", line 665, in _save
    raise OSError(msg) from e
OSError: cannot write mode RGBA as JPEG
2025-11-11 13:03:59 - PhotoCropPipeline - ERROR -   ‚úó Error en procesamiento
2025-11-11 13:03:59 - PhotoCropPipeline - ERROR -   ‚úó Imagen con error ‚Üí errors/2025/batch_20251111_130357/61425151.jpg
2025-11-11 13:03:59 - PhotoCropPipeline - INFO - 
============================================================
2025-11-11 13:03:59 - PhotoCropPipeline - INFO - Procesando: 61425961.jpeg
2025-11-11 13:03:59 - PhotoCropPipeline - INFO - ============================================================
2025-11-11 13:03:59 - PhotoCropPipeline - INFO - 4.1 Validaci√≥n b√°sica...
2025-11-11 13:03:59 - PhotoCropPipeline - INFO -   Dimensiones: 1200x1600
2025-11-11 13:03:59 - PhotoCropPipeline - INFO -   Formato: JPEG
2025-11-11 13:03:59 - PhotoCropPipeline - INFO - 4.2 Creando metadato inicial...
2025-11-11 13:03:59 - PhotoCropPipeline - INFO -   Orientaci√≥n: portrait
2025-11-11 13:03:59 - PhotoCropPipeline - INFO - 4.3 Detecci√≥n facial con dlib...
2025-11-11 13:04:00 - PhotoCropPipeline - INFO -   Rostros detectados: 1
2025-11-11 13:04:00 - PhotoCropPipeline - INFO -   ‚úì Un rostro detectado
2025-11-11 13:04:00 - PhotoCropPipeline - INFO -   ‚úì Aplicando recorte...
2025-11-11 13:04:00 - PhotoCropPipeline - INFO -   ‚úì Guardado en working: working/faces_cropped/61425961.jpeg
2025-11-11 13:04:00 - PhotoCropPipeline - INFO -   üé® Removiendo fondo con IA...
2025-11-11 13:04:01 - PhotoCropPipeline - INFO -   ‚úì Fondo removido: prepared/61425961.jpg
2025-11-11 13:04:01 - PhotoCropPipeline - INFO -   ‚úì Guardado en output_white: output_white/61425961.jpeg
2025-11-11 13:04:01 - PhotoCropPipeline - INFO -   üîÑ Convirtiendo a formato original: .jpeg
2025-11-11 13:04:01 - PhotoCropPipeline - INFO -   ‚úì Imagen procesada exitosamente ‚Üí output/61425961.jpeg
2025-11-11 13:04:01 - PhotoCropPipeline - INFO - 
============================================================
2025-11-11 13:04:01 - PhotoCropPipeline - INFO - Procesando: 61424116.jpeg
2025-11-11 13:04:01 - PhotoCropPipeline - INFO - ============================================================
2025-11-11 13:04:01 - PhotoCropPipeline - INFO - 4.1 Validaci√≥n b√°sica...
2025-11-11 13:04:01 - PhotoCropPipeline - INFO -   Dimensiones: 472x591
2025-11-11 13:04:01 - PhotoCropPipeline - INFO -   Formato: JPEG
2025-11-11 13:04:01 - PhotoCropPipeline - INFO - 4.2 Creando metadato inicial...
2025-11-11 13:04:01 - PhotoCropPipeline - INFO -   Orientaci√≥n: portrait
2025-11-11 13:04:01 - PhotoCropPipeline - INFO - 4.3 Detecci√≥n facial con dlib...
2025-11-11 13:04:01 - PhotoCropPipeline - INFO -   Rostros detectados: 1
2025-11-11 13:04:01 - PhotoCropPipeline - INFO -   ‚úì Un rostro detectado
2025-11-11 13:04:01 - PhotoCropPipeline - INFO -   ‚úì Aplicando recorte...
2025-11-11 13:04:01 - PhotoCropPipeline - INFO -   ‚úì Guardado en working: working/faces_cropped/61424116.jpeg
2025-11-11 13:04:01 - PhotoCropPipeline - INFO -   üé® Removiendo fondo con IA...
2025-11-11 13:04:02 - PhotoCropPipeline - INFO -   ‚úì Fondo removido: prepared/61424116.jpg
2025-11-11 13:04:02 - PhotoCropPipeline - INFO -   ‚úì Guardado en output_white: output_white/61424116.jpeg
2025-11-11 13:04:02 - PhotoCropPipeline - INFO -   üîÑ Convirtiendo a formato original: .jpeg
2025-11-11 13:04:02 - PhotoCropPipeline - INFO -   ‚úì Imagen procesada exitosamente ‚Üí output/61424116.jpeg
2025-11-11 13:04:02 - PhotoCropPipeline - INFO - 
============================================================
2025-11-11 13:04:02 - PhotoCropPipeline - INFO - Procesando: 61427325.jpeg
2025-11-11 13:04:02 - PhotoCropPipeline - INFO - ============================================================
2025-11-11 13:04:02 - PhotoCropPipeline - INFO - 4.1 Validaci√≥n b√°sica...
2025-11-11 13:04:02 - PhotoCropPipeline - INFO -   Dimensiones: 1198x1600
2025-11-11 13:04:02 - PhotoCropPipeline - INFO -   Formato: JPEG
2025-11-11 13:04:02 - PhotoCropPipeline - INFO - 4.2 Creando metadato inicial...
2025-11-11 13:04:02 - PhotoCropPipeline - INFO -   Orientaci√≥n: portrait
2025-11-11 13:04:02 - PhotoCropPipeline - INFO - 4.3 Detecci√≥n facial con dlib...
2025-11-11 13:04:03 - PhotoCropPipeline - INFO -   Rostros detectados: 1
2025-11-11 13:04:03 - PhotoCropPipeline - INFO -   ‚úì Un rostro detectado
2025-11-11 13:04:03 - PhotoCropPipeline - INFO -   ‚úì Aplicando recorte...
2025-11-11 13:04:03 - PhotoCropPipeline - INFO -   ‚úì Guardado en working: working/faces_cropped/61427325.jpeg
2025-11-11 13:04:03 - PhotoCropPipeline - INFO -   üé® Removiendo fondo con IA...
2025-11-11 13:04:04 - PhotoCropPipeline - INFO -   ‚úì Fondo removido: prepared/61427325.jpg
2025-11-11 13:04:04 - PhotoCropPipeline - INFO -   ‚úì Guardado en output_white: output_white/61427325.jpeg
2025-11-11 13:04:04 - PhotoCropPipeline - INFO -   üîÑ Convirtiendo a formato original: .jpeg
2025-11-11 13:04:04 - PhotoCropPipeline - INFO -   ‚úì Imagen procesada exitosamente ‚Üí output/61427325.jpeg
2025-11-11 13:04:04 - PhotoCropPipeline - INFO - 
============================================================
2025-11-11 13:04:04 - PhotoCropPipeline - INFO - Procesando: 61424048.jpeg
2025-11-11 13:04:04 - PhotoCropPipeline - INFO - ============================================================
2025-11-11 13:04:04 - PhotoCropPipeline - INFO - 4.1 Validaci√≥n b√°sica...
2025-11-11 13:04:04 - PhotoCropPipeline - INFO -   Dimensiones: 347x470
2025-11-11 13:04:04 - PhotoCropPipeline - INFO -   Formato: JPEG
2025-11-11 13:04:04 - PhotoCropPipeline - INFO - 4.2 Creando metadato inicial...
2025-11-11 13:04:04 - PhotoCropPipeline - INFO -   Orientaci√≥n: portrait
2025-11-11 13:04:04 - PhotoCropPipeline - INFO - 4.3 Detecci√≥n facial con dlib...
2025-11-11 13:04:04 - PhotoCropPipeline - INFO -   Rostros detectados: 1
2025-11-11 13:04:04 - PhotoCropPipeline - INFO -   ‚úì Un rostro detectado
2025-11-11 13:04:04 - PhotoCropPipeline - INFO -   ‚úì Aplicando recorte...
2025-11-11 13:04:04 - PhotoCropPipeline - INFO -   ‚úì Guardado en working: working/faces_cropped/61424048.jpeg
2025-11-11 13:04:04 - PhotoCropPipeline - INFO -   üé® Removiendo fondo con IA...
2025-11-11 13:04:05 - PhotoCropPipeline - INFO -   ‚úì Fondo removido: prepared/61424048.jpg
2025-11-11 13:04:05 - PhotoCropPipeline - INFO -   ‚úì Guardado en output_white: output_white/61424048.jpeg
2025-11-11 13:04:05 - PhotoCropPipeline - INFO -   üîÑ Convirtiendo a formato original: .jpeg
2025-11-11 13:04:05 - PhotoCropPipeline - INFO -   ‚úì Imagen procesada exitosamente ‚Üí output/61424048.jpeg
2025-11-11 13:04:05 - PhotoCropPipeline - INFO - 
============================================================
2025-11-11 13:04:05 - PhotoCropPipeline - INFO - Procesando: 61424844.jpeg
2025-11-11 13:04:05 - PhotoCropPipeline - INFO - ============================================================
2025-11-11 13:04:05 - PhotoCropPipeline - INFO - 4.1 Validaci√≥n b√°sica...
2025-11-11 13:04:05 - PhotoCropPipeline - INFO -   Dimensiones: 459x562
2025-11-11 13:04:05 - PhotoCropPipeline - INFO -   Formato: JPEG
2025-11-11 13:04:05 - PhotoCropPipeline - INFO - 4.2 Creando metadato inicial...
2025-11-11 13:04:05 - PhotoCropPipeline - INFO -   Orientaci√≥n: portrait
2025-11-11 13:04:05 - PhotoCropPipeline - INFO - 4.3 Detecci√≥n facial con dlib...
2025-11-11 13:04:05 - PhotoCropPipeline - INFO -   Rostros detectados: 1
2025-11-11 13:04:05 - PhotoCropPipeline - INFO -   ‚úì Un rostro detectado
2025-11-11 13:04:05 - PhotoCropPipeline - INFO -   ‚úì Aplicando recorte...
2025-11-11 13:04:05 - PhotoCropPipeline - INFO -   ‚úì Guardado en working: working/faces_cropped/61424844.jpeg
2025-11-11 13:04:05 - PhotoCropPipeline - INFO -   üé® Removiendo fondo con IA...
2025-11-11 13:04:06 - PhotoCropPipeline - INFO -   ‚úì Fondo removido: prepared/61424844.jpg
2025-11-11 13:04:06 - PhotoCropPipeline - INFO -   ‚úì Guardado en output_white: output_white/61424844.jpeg
2025-11-11 13:04:06 - PhotoCropPipeline - INFO -   üîÑ Convirtiendo a formato original: .jpeg
2025-11-11 13:04:06 - PhotoCropPipeline - INFO -   ‚úì Imagen procesada exitosamente ‚Üí output/61424844.jpeg
2025-11-11 13:04:06 - PhotoCropPipeline - INFO - 
============================================================
2025-11-11 13:04:06 - PhotoCropPipeline - INFO - Procesando: 61424580.jpg
2025-11-11 13:04:06 - PhotoCropPipeline - INFO - ============================================================
2025-11-11 13:04:06 - PhotoCropPipeline - INFO - 4.1 Validaci√≥n b√°sica...
2025-11-11 13:04:06 - PhotoCropPipeline - INFO -   Dimensiones: 276x354
2025-11-11 13:04:06 - PhotoCropPipeline - INFO -   Formato: PNG
2025-11-11 13:04:06 - PhotoCropPipeline - INFO - 4.2 Creando metadato inicial...
2025-11-11 13:04:06 - PhotoCropPipeline - INFO -   Orientaci√≥n: portrait
2025-11-11 13:04:06 - PhotoCropPipeline - INFO - 4.3 Detecci√≥n facial con dlib...
2025-11-11 13:04:06 - PhotoCropPipeline - INFO -   Rostros detectados: 1
2025-11-11 13:04:06 - PhotoCropPipeline - INFO -   ‚úì Un rostro detectado
2025-11-11 13:04:06 - PhotoCropPipeline - INFO -   ‚úì Aplicando recorte...
2025-11-11 13:04:06 - PhotoCropPipeline - ERROR - Error inesperado: cannot write mode RGBA as JPEG
Traceback (most recent call last):
  File "/home/lmayta/PycharmProjects/PhotoCrop/.venv/lib/python3.12/site-packages/PIL/JpegImagePlugin.py", line 662, in _save
    rawmode = RAWMODE[im.mode]
              ~~~~~~~^^^^^^^^^
KeyError: 'RGBA'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/lmayta/PycharmProjects/PhotoCrop/src/deterministic_processor.py", line 370, in _process_single_file
    self._handle_single_face(img_path, img, metadata, batch_id, face_box)
  File "/home/lmayta/PycharmProjects/PhotoCrop/src/deterministic_processor.py", line 523, in _handle_single_face
    self._process_successful_crop(img_path, img, metadata, batch_id, crop_decision["crop_box"])
  File "/home/lmayta/PycharmProjects/PhotoCrop/src/processor_with_bg_removal.py", line 104, in _process_successful_crop
    cropped_img.save(working_path, 'JPEG', quality=95)
  File "/home/lmayta/PycharmProjects/PhotoCrop/.venv/lib/python3.12/site-packages/PIL/Image.py", line 2571, in save
    save_handler(self, fp, filename)
  File "/home/lmayta/PycharmProjects/PhotoCrop/.venv/lib/python3.12/site-packages/PIL/JpegImagePlugin.py", line 665, in _save
    raise OSError(msg) from e
OSError: cannot write mode RGBA as JPEG
2025-11-11 13:04:06 - PhotoCropPipeline - ERROR -   ‚úó Error en procesamiento
2025-11-11 13:04:06 - PhotoCropPipeline - ERROR -   ‚úó Imagen con error ‚Üí errors/2025/batch_20251111_130357/61424580.jpg
2025-11-11 13:04:06 - PhotoCropPipeline - INFO - 
============================================================
2025-11-11 13:04:06 - PhotoCropPipeline - INFO - Procesando: 61424638.jpeg
2025-11-11 13:04:06 - PhotoCropPipeline - INFO - ============================================================
2025-11-11 13:04:06 - PhotoCropPipeline - INFO - 4.1 Validaci√≥n b√°sica...
2025-11-11 13:04:06 - PhotoCropPipeline - INFO -   Dimensiones: 1204x1600
2025-11-11 13:04:06 - PhotoCropPipeline - INFO -   Formato: JPEG
2025-11-11 13:04:06 - PhotoCropPipeline - INFO - 4.2 Creando metadato inicial...
2025-11-11 13:04:06 - PhotoCropPipeline - INFO -   Orientaci√≥n: portrait
2025-11-11 13:04:06 - PhotoCropPipeline - INFO - 4.3 Detecci√≥n facial con dlib...
2025-11-11 13:04:06 - PhotoCropPipeline - INFO -   Rostros detectados: 1
2025-11-11 13:04:06 - PhotoCropPipeline - INFO -   ‚úì Un rostro detectado
2025-11-11 13:04:06 - PhotoCropPipeline - INFO -   ‚úì Aplicando recorte...
2025-11-11 13:04:06 - PhotoCropPipeline - INFO -   ‚úì Guardado en working: working/faces_cropped/61424638.jpeg
2025-11-11 13:04:06 - PhotoCropPipeline - INFO -   üé® Removiendo fondo con IA...
2025-11-11 13:04:07 - PhotoCropPipeline - INFO -   ‚úì Fondo removido: prepared/61424638.jpg
2025-11-11 13:04:07 - PhotoCropPipeline - INFO -   ‚úì Guardado en output_white: output_white/61424638.jpeg
2025-11-11 13:04:07 - PhotoCropPipeline - INFO -   üîÑ Convirtiendo a formato original: .jpeg
2025-11-11 13:04:07 - PhotoCropPipeline - INFO -   ‚úì Imagen procesada exitosamente ‚Üí output/61424638.jpeg
2025-11-11 13:04:07 - PhotoCropPipeline - INFO - 
============================================================
2025-11-11 13:04:07 - PhotoCropPipeline - INFO - Procesando: 61424702.png
2025-11-11 13:04:07 - PhotoCropPipeline - INFO - ============================================================
2025-11-11 13:04:07 - PhotoCropPipeline - INFO - 4.1 Validaci√≥n b√°sica...
2025-11-11 13:04:07 - PhotoCropPipeline - INFO -   Dimensiones: 1024x1536
2025-11-11 13:04:07 - PhotoCropPipeline - INFO -   Formato: PNG
2025-11-11 13:04:07 - PhotoCropPipeline - INFO - 4.2 Creando metadato inicial...
2025-11-11 13:04:07 - PhotoCropPipeline - INFO -   Orientaci√≥n: portrait
2025-11-11 13:04:07 - PhotoCropPipeline - INFO - 4.3 Detecci√≥n facial con dlib...
2025-11-11 13:04:08 - PhotoCropPipeline - INFO -   Rostros detectados: 1
2025-11-11 13:04:08 - PhotoCropPipeline - INFO -   ‚úì Un rostro detectado
2025-11-11 13:04:08 - PhotoCropPipeline - INFO -   ‚úì Aplicando recorte...
2025-11-11 13:04:08 - PhotoCropPipeline - INFO -   ‚úì Guardado en working: working/faces_cropped/61424702.png
2025-11-11 13:04:08 - PhotoCropPipeline - INFO -   üé® Removiendo fondo con IA...
2025-11-11 13:04:09 - PhotoCropPipeline - INFO -   ‚úì Fondo removido: prepared/61424702.jpg
2025-11-11 13:04:10 - PhotoCropPipeline - INFO -   ‚úì Guardado en output_white: output_white/61424702.png
2025-11-11 13:04:10 - PhotoCropPipeline - INFO -   üîÑ Convirtiendo a formato original: .png
2025-11-11 13:04:10 - PhotoCropPipeline - INFO -   ‚úì Imagen procesada exitosamente ‚Üí output/61424702.png
2025-11-11 13:04:10 - PhotoCropPipeline - INFO - 
================================================================================
2025-11-11 13:04:10 - PhotoCropPipeline - INFO - 7. RESUMEN DE PROCESAMIENTO
2025-11-11 13:04:10 - PhotoCropPipeline - INFO - ================================================================================
2025-11-11 13:04:10 - PhotoCropPipeline - INFO - Total encontrados: 10
2025-11-11 13:04:10 - PhotoCropPipeline - INFO - Saltados (ya procesados): 0
2025-11-11 13:04:10 - PhotoCropPipeline - INFO - Nuevos procesados:
2025-11-11 13:04:10 - PhotoCropPipeline - INFO -   ‚úì Exitosos: 8
2025-11-11 13:04:10 - PhotoCropPipeline - INFO -   ‚ö†Ô∏è  Revisi√≥n manual: 0
2025-11-11 13:04:10 - PhotoCropPipeline - INFO -   ‚úó Errores: 2
2025-11-11 13:04:10 - PhotoCropPipeline - INFO - ================================================================================
